---
# file: tasks/config_nagios.yml


- name: Configure Generic Nagios stuff
  template:
    src: '{{ item.src }}'
    dest: '{{ item.dest }}'
    owner: 'root'
    group: 'root'
    mode: 0644
  with_items:
    - { src: 'localhost_thruk.cfg.j2', dest: '{{ nagios_config_cfg_dir }}/localhost_thruk.cfg' }
  notify: Reload Nagios
  
- name: lineinfile - configure nagios.cfg for check-mk
  lineinfile: "dest={{ nagios_config_file }} regexp='{{ item.src }}' line='{{ item.value }}'"
  with_items:
  - { src: "^broker_module=" , value: "broker_module={{ nagios_config_broker_module }}" }
  notify: Restart Nagios